---
kind: Policy
apiVersion: config.kio.kasten.io/v1alpha1
metadata:
  name: home-automation-backup
  namespace: kasten-io
spec:
  frequency: "@daily"
  retention:
    daily: 7
    weekly: 4
    monthly: 12
  selector:
    matchExpressions:
      - key: k10.kasten.io/appNamespace
        operator: In
        values:
          - home-automation
  actions:
    - action: backup
      backupParameters:
        filters:
          includeResources:
            - resource: persistentvolumeclaims
              matchExpressions:
                - key: kasten.io/backup-volume
                  operator: In
                  values:
                    - enabled
        profile:
          name: home-automation
          namespace: kasten-io
    - action: export
      exportParameters:
        frequency: "@daily"
        receiveString: bIzAPpoanmEIlXJIghhWz9FmGz4ZKhHF3RCX91soQ4l8GcpEtDy5bZacJN6YnvAxfRvKzKuNGU+u7zELhTr9gGkLk1sHKM2bV5WQ793U1Zigqfk54mFOZAKhzKv+XrFXbooRhmJrwsh8lbOQ7NzInguSIN7yi1VbtSDNOArPytuVxpMGKlHQvUmOkD/WPhpiualnSImo+3Zm00o3MTiL9929XXSzHSjrpihO/IrbWJdep4bOOnTYbsUDs6SuidqyZJbfIPjMK9NzS3Dooksp7mDI4OOZKrOO1QuPBCp2XnF8W3HTsmo8u3y0vdqP9Nx5y0MhPNNHjzsIl8khjy7cBawM4q1Rbl9ZqLEthJaaqqjlhFzbxZrBt2poyQzzkyRr4d+jNZVfyP25GDNz+4i7K0Pmnf5JQPksvl6Ic7bCn+EXhJeRgAyk
        profile:
          name: home-automation
          namespace: kasten-io
        # migrationToken:
        #   name: home-automation-backup-migration-token-nkr7z
        #   namespace: kasten-io
        exportData:
          enabled: true
      retention: {}
